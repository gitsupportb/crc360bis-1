[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

# Main Dashboard (Next.js) - Port 3000
[program:main-dashboard]
command=pnpm start
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/main-dashboard.err.log
stdout_logfile=/var/log/supervisor/main-dashboard.out.log
environment=NODE_ENV="production",PORT="3000"

# Rep Watch Dashboard (Next.js) - Port 3010
[program:rep-watch]
command=pnpm start
directory=/app/app/dashboard/bcp2s-risk-platform
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/rep-watch.err.log
stdout_logfile=/var/log/supervisor/rep-watch.out.log
environment=NODE_ENV="production",PORT="3010"

# Documents Service (Next.js) - Port 3003
[program:docs-service]
command=pnpm start
directory=/app/app/documents/bcp-docs-platforme
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/docs-service.err.log
stdout_logfile=/var/log/supervisor/docs-service.out.log
environment=NODE_ENV="production",PORT="3003"

# Calculs Service (Next.js) - Port 3005
[program:calculs-service]
command=pnpm start
directory=/app/app/calculs/bcp2s-risk-platform
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/calculs-service.err.log
stdout_logfile=/var/log/supervisor/calculs-service.out.log
environment=NODE_ENV="production",PORT="3005"

# AML Service (Node.js/Express) - Port 5000
[program:aml-service]
command=node server.js
directory=/app/app/aml/LBCFT WEBAPP (1)/LBCFT WEBAPP
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/aml-service.err.log
stdout_logfile=/var/log/supervisor/aml-service.out.log
environment=NODE_ENV="production",PORT="5000"

# AMMC Django Service - Port 8080
[program:ammc-service]
command=python3 manage.py runserver 0.0.0.0:8080
directory=/app/app/dashboard/bcp2s-risk-platform/AMMC
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/ammc-service.err.log
stdout_logfile=/var/log/supervisor/ammc-service.out.log
environment=DJANGO_SETTINGS_MODULE="AMMC.settings",DEBUG="1"

# BAM Django Service - Port 8000
[program:bam-service]
command=python3 manage.py runserver 0.0.0.0:8000
directory=/app/app/dashboard/bcp2s-risk-platform/components/myfirstproject
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/bam-service.err.log
stdout_logfile=/var/log/supervisor/bam-service.out.log
environment=DJANGO_SETTINGS_MODULE="myfirstproject.settings",DEBUG="1"

[group:bcp2s-services]
programs=main-dashboard,rep-watch,docs-service,calculs-service,aml-service,ammc-service,bam-service
priority=999
